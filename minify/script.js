function registerEvents(){$("#soundbyte_search").on("keypress",function(e){13===e.which&&($("#page").val("1"),getSoundbytes($("#soundbyte_search").val(),$("#soundbyte_genre").val(),1))}),$("#soundbyte_genre").change(function(){$("#soundbyte_search").val(""),$("#page").html("1"),$("#pag_left_button").hide(),$("#pag_right_button").show(),getSoundbytes($("#soundbyte_search").val(),$("#soundbyte_genre").val(),1)}),$("#pag_left_button").click(function(){var e=parseInt($("#page").html());e-=1,$("#page").html(e),getSoundbytes($("#soundbyte_search").val(),$("#soundbyte_genre").val(),e)}),$("#pag_right_button").click(function(){var e=parseInt($("#page").html());e+=1,$("#page").html(e),getSoundbytes($("#soundbyte_search").val(),$("#soundbyte_genre").val(),e)}),$("#refresh_stats").click(function(){getStats()})}function authing(){getStats(),registerEvents()}function authed(e,t,n){authenticated=!0,$("#stats").show(),$("#welcome").hide(),$("#auth").hide(),$("#auth_welcome").show(),$("#auth_welcome_msg").html("Hello "+e+"!"),$("#doubloon_count").html(t),$("#soundbyte_credit_count").html(n),$("#soundbytes").show(),alertSuccess("Successfully connected to your account!"),getGenres(),getSoundbytes("","all",1)}function getStats(){null!=panel_token&&$.ajax({url:"https://burkeblack.tv/extensions/burkes_booty/api.php?action=stats",type:"get",headers:{"x-extension-jwt":panel_token,accept:"application/json"},dataType:"json",success:function(e){e.successful?($("#pagination").show(),authed(e.username,e.doubloons,e.soundbyte_credits)):($("#pagination").hide(),alertFail(e.message))}})}function getGenres(){null!=panel_token&&$.ajax({url:"https://burkeblack.tv/extensions/burkes_booty/api.php?action=genres",type:"get",headers:{"x-extension-jwt":panel_token,accept:"application/json"},dataType:"json",success:function(e){if(e.successful){$("#pagination").show();var t=e.genres;$("#soundbyte_genre").empty(),$("#soundbyte_genre").append('<option selected="selected" value="all">All</option>'),$.each(t,function(e,t){$("#soundbyte_genre").append('<option value="'+t.text+'">'+t.text+"</option>")})}else $("#pagination").hide(),alertFail(e.message)}})}function getSoundbytes(e,t,n){$.ajax({url:"https://burkeblack.tv/extensions/burkes_booty/api.php?action=soundbytes&search_text="+e+"&search_genre="+t+"&page="+n,type:"get",headers:{"x-extension-jwt":panel_token,accept:"application/json"},dataType:"json",success:function(e){if(e.successful){$("#pagination").show(),$("#soundbyte_Table_body").empty();var t=e.soundbytes;e.page_left?$("#pag_left_button").show():$("#pag_left_button").hide(),e.page_right?$("#pag_right_button").show():$("#pag_right_button").hide(),$.each(t,function(e,t){var n="<tr>\n                    <td>"+t.text+'</td>\n                    <td class="send_cell"><button type="button" class="btn_send" id="sb_'+t.id+'">Send!</button></td>\n                </tr>';$("#soundbyte_Table_body").append(n),$("#sb_"+t.id).on("click",function(){sendSoundbyte(t.id)})})}else $("#pagination").hide(),alertFail(e.message)}})}function sendSoundbyte(e){var t;t=announce?"https://burkeblack.tv/extensions/burkes_booty/api.php?action=sendSoundbyte&soundbyteId="+e+"&announce=1":"https://burkeblack.tv/extensions/burkes_booty/api.php?action=sendSoundbyte&soundbyteId="+e+"&announce=0",$.ajax({url:t,type:"get",headers:{"x-extension-jwt":panel_token,accept:"application/json"},dataType:"json",success:function(t){t.successful?(alertSuccess("Soundbyte["+e+"] successfully sent!"),getStats()):alertFail(t.message)}})}function alertSuccess(e){$("#success_msg").html(e),$("#fail").hide(),$("#success").show()}function alertFail(e){$("#fail_msg").html(e),$("#success").hide(),$("#fail").show()}var panel_token,announce=!0,authenticated=!1;window.Twitch.ext.onAuthorized(function(e){panel_token=e.token;var t=e.token.split(".");JSON.parse(window.atob(t[1])).user_id?($("#auth").hide(),$("#welcome").html("Logging you in..."),setTimeout(authing,2e3)):($("#stats").hide(),$("#welcome").show(),$("#auth").show(),$("#auth_welcome").hide(),$("#soundbytes").hide())}),window.Twitch.ext.onError(function(e){console.log("Burke's Booty Error:"+e)}),$(document).ready(function(){$("#credit_link").click(function(){console.log("fired"),$("#credit_info").is(":visible")?(!$("#soundbytes").is(":visible")&&authed&&$("#soundbytes").show(),$("#credit_info").hide()):($("#soundbytes").hide(),$("#credit_info").show())}),$("#settings_link").click(function(){$("#settings_info").is(":visible")?($("#settings_info").hide(),!$("#soundbytes").is(":visible")&&authed&&$("#soundbytes").show()):($("#settings_info").show(),$("#soundbytes").hide())}),$("#announce_yes_button").click(function(){$("#announce_yes_button").addClass("settings_button_selected"),$("#announce_no_button").removeClass("settings_button_selected"),$("#announce_yes_button").prop("disabled",!0),$("#announce_no_button").prop("disabled",!1),announce=!0}),$("#announce_no_button").click(function(){$("#announce_no_button").addClass("settings_button_selected"),$("#announce_yes_button").removeClass("settings_button_selected"),$("#announce_yes_button").prop("disabled",!1),$("#announce_no_button").prop("disabled",!0),announce=!1})});